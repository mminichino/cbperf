{
  "inventory": [
    {
      "external_file": {
        "buckets": [
          {
            "name": "{{ BUCKET_PARAMETER }}",
            "scopes": [
              {
                "name": "_default",
                "collections": [
                  {
                    "name": "_default",
                    "schema": "{{ FILE_PARAMETER }}",
                    "idkey": "{{ ID_FIELD_PARAMETER }}",
                    "primary_index": false,
                    "override_count": false,
                    "indexes": [
                      "{{ ID_FIELD_PARAMETER }}"
                    ]
                  }
                ]
              }
            ]
          }
        ]
      }
    },
    {
      "default": {
        "buckets": [
          {
            "name": "cbperf",
            "scopes": [
              {
                "name": "_default",
                "collections": [
                  {
                    "name": "_default",
                    "schema": {
                      "record_id": "record_id",
                      "first_name": "{{ rand_first }}",
                      "last_name": "{{ rand_last }}",
                      "address": "{{ rand_address }}",
                      "city": "{{ rand_city }}",
                      "state": "{{ rand_state }}",
                      "zip_code": "{{ rand_zip_code }}",
                      "phone": "{{ rand_phone }}",
                      "ssn": "{{ rand_ssn }}",
                      "dob": "{{ rand_dob_1 }}",
                      "account_number": "{{ rand_account }}",
                      "card_number": "{{ rand_credit_card }}",
                      "transactions": [
                        {
                          "id": "{{ rand_id }}",
                          "date": "{{ rand_date_1 }}",
                          "amount": "{{ rand_dollar }}"
                        }
                      ]
                    },
                    "idkey": "record_id",
                    "primary_index": false,
                    "override_count": false,
                    "indexes": [
                      "record_id",
                      "last_name"
                    ]
                  }
                ]
              }
            ]
          }
        ]
      }
    },
    {
      "profile_demo": {
        "buckets": [
          {
            "name": "sample_app",
            "scopes": [
              {
                "name": "profiles",
                "collections": [
                  {
                    "name": "user_data",
                    "schema": {
                      "record_id": "record_id",
                      "name": "{{ rand_first }} {{ rand_last }}",
                      "nickname": "{{ rand_nickname }}",
                      "picture": "",
                      "user_id": "{{ rand_username }}",
                      "email": "{{ rand_email }}",
                      "email_verified": "{{ rand_bool }}",
                      "first_name": "{{ rand_first }}",
                      "last_name": "{{ rand_last }}",
                      "address": "{{ rand_address }}",
                      "city": "{{ rand_city }}",
                      "state": "{{ rand_state }}",
                      "zip_code": "{{ rand_zip_code }}",
                      "phone": "{{ rand_phone }}",
                      "date_of_birth": "{{ rand_dob_1 }}"
                    },
                    "idkey": "record_id",
                    "primary_index": true,
                    "override_count": false,
                    "indexes": [
                      "record_id",
                      "nickname",
                      "user_id"
                    ]
                  },
                  {
                    "name": "user_images",
                    "schema": {
                      "record_id": "record_id",
                      "type": "jpeg",
                      "image": "{{ rand_image }}"
                    },
                    "idkey": "record_id",
                    "primary_index": true,
                    "override_count": false,
                    "batch_size": 10,
                    "indexes": [
                      "record_id"
                    ]
                  },
                  {
                    "name": "service_auth",
                    "schema": {
                      "record_id": "record_id",
                      "token": "{{ rand_hash }}"
                    },
                    "idkey": "record_id",
                    "primary_index": true,
                    "override_count": true,
                    "record_count": 1,
                    "indexes": [
                      "record_id"
                    ]
                  }
                ]
              }
            ]
          }
        ],
        "rules": [
          {
            "name": "rule0",
            "type": "link",
            "id_field": "record_id",
            "foreign_key": "sample_app:profiles:user_data:picture",
            "primary_key": "sample_app:profiles:user_images:record_id",
            "sql" : "MERGE INTO sample_app.profiles.user_data u USING sample_app.profiles.user_images i ON u.record_id = i.record_id WHEN MATCHED THEN UPDATE SET u.picture = meta(i).id ;"
          }
        ]
      }
    },
    {
      "employee_demo": {
        "buckets": [
          {
            "name": "employees",
            "scopes": [
              {
                "name": "_default",
                "collections": [
                  {
                    "name": "_default",
                    "schema": {
                      "record_id": "record_id",
                      "store_id": "{{ incr_block }}",
                      "employee_id": "{{ incr_value }}",
                      "name": "{{ rand_first }} {{ rand_last }}",
                      "user_id": "{{ rand_username }}",
                      "email": "{{ rand_email }}",
                      "email_verified": "{{ rand_bool }}",
                      "first_name": "{{ rand_first }}",
                      "last_name": "{{ rand_last }}",
                      "address": "{{ rand_address }}",
                      "city": "{{ rand_city }}",
                      "state": "{{ rand_state }}",
                      "zip_code": "{{ rand_zip_code }}",
                      "phone": "{{ rand_phone }}",
                      "date_of_birth": "{{ rand_dob_1 }}",
                      "password": "{{ rand_password }}",
                      "timecards": []
                    },
                    "idkey": "record_id",
                    "primary_index": false,
                    "override_count": false,
                    "indexes": [
                      "record_id",
                      "store_id",
                      "employee_id"
                    ]
                  }
                ]
              }
            ]
          }
        ]
      }
    },
    {
      "adjuster_demo": {
        "buckets": [
          {
            "name": "adjuster_demo",
            "scopes": [
              {
                "name": "data",
                "collections": [
                  {
                    "name": "claims",
                    "schema": {
                      "record_id": "record_id",
                      "claim_id": "{{ incr_block }}",
                      "claim_date": "{{ date_time }}",
                      "customer_id": "",
                      "adjuster_id": "",
                      "claim_amount": 0.0,
                      "claim_status": 0,
                      "claim_paid": false
                    },
                    "idkey": "record_id",
                    "primary_index": false,
                    "override_count": false,
                    "indexes": [
                      "record_id",
                      "claim_id",
                      "customer_id"
                    ]
                  },
                  {
                    "name": "claim_images",
                    "schema": {
                      "record_id": "record_id",
                      "claim_id": "",
                      "type": "",
                      "image": ""
                    },
                    "idkey": "record_id",
                    "primary_index": false,
                    "override_count": true,
                    "batch_size": 10,
                    "record_count": 0,
                    "indexes": [
                      "record_id",
                      "claim_id"
                    ]
                  },
                  {
                    "name": "customers",
                    "schema": {
                      "record_id": "record_id",
                      "customer_id": "{{ incr_value }}",
                      "name": "{{ rand_first }} {{ rand_last }}",
                      "user_id": "{{ rand_username }}",
                      "email": "{{ rand_email }}",
                      "email_verified": true,
                      "first_name": "{{ rand_first }}",
                      "last_name": "{{ rand_last }}",
                      "address": "{{ rand_address }}",
                      "city": "{{ rand_city }}",
                      "state": "{{ rand_state }}",
                      "zip_code": "{{ rand_zip_code }}",
                      "phone": "{{ rand_phone }}",
                      "date_of_birth": "{{ rand_dob_1 }}",
                      "password": "{{ rand_password }}"
                    },
                    "idkey": "record_id",
                    "primary_index": false,
                    "override_count": false,
                    "indexes": [
                      "record_id",
                      "customer_id",
                      "user_id",
                      "email"
                    ]
                  },
                  {
                    "name": "adjusters",
                    "schema": {
                      "record_id": "record_id",
                      "employee_id": "{{ incr_value }}",
                      "division": "automotive",
                      "user_id": "{{ rand_username }}",
                      "email": "{{ rand_email }}",
                      "first_name": "{{ rand_first }}",
                      "last_name": "{{ rand_last }}",
                      "address": "{{ rand_address }}",
                      "city": "{{ rand_city }}",
                      "state": "{{ rand_state }}",
                      "zip_code": "{{ rand_zip_code }}",
                      "phone": "{{ rand_phone }}",
                      "password": "{{ rand_password }}"
                    },
                    "idkey": "record_id",
                    "primary_index": false,
                    "override_count": true,
                    "record_count": 10,
                    "indexes": [
                      "record_id",
                      "user_id",
                      "email",
                      "employee_id",
                      "division"
                    ]
                  }
                ]
              }
            ]
          }
        ],
        "rules": [
          {
            "name": "rule0",
            "type": "sql",
            "id_field": "record_id",
            "foreign_key": "adjuster_demo:data:claims:customer_id",
            "primary_key": "adjuster_demo:data:customers:customer_id",
            "sql" : "MERGE INTO adjuster_demo.data.claims u USING adjuster_demo.data.customers i ON u.record_id = i.record_id WHEN MATCHED THEN UPDATE SET u.customer_id = i.customer_id ;"
          }
        ]
      }
    }
  ]
}
